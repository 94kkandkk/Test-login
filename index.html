<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bmob 核心注册登录</title>
    <!-- 引入Bmob官方SDK（核心依赖，解决所有网络/接口调用问题） -->
    <script src="https://cdn.jsdelivr.net/npm/bmob-js-sdk@1.4.10/dist/bmob.min.js"></script>
    <style>
        /* 极简样式，仅保证功能可用 */
        body {max-width: 400px; margin: 50px auto; padding: 0 20px; font-family: sans-serif;}
        input {width: 100%; padding: 10px; margin: 8px 0; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px;}
        button {width: 100%; padding: 12px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;}
        button:hover {background: #0056b3;}
        .result {margin-top: 20px; padding: 10px; border-radius: 4px; font-size: 14px;}
        .success {background: #d4edda; color: #155724;}
        .error {background: #f8d7da; color: #721c24;}
    </style>
</head>
<body>
    <h3>用户注册</h3>
    <input type="text" id="regUsername" placeholder="请输入注册用户名" required>
    <input type="password" id="regPwd" placeholder="请输入注册密码" required>
    <button onclick="userRegister()">立即注册</button>

    <hr style="margin: 30px 0;">

    <h3>用户登录</h3>
    <input type="text" id="loginUsername" placeholder="请输入用户名" required>
    <input type="password" id="loginPwd" placeholder="请输入密码" required>
    <button onclick="userLogin()">立即登录</button>

    <!-- 结果提示框 -->
    <div id="resultBox" class="result" style="display: none;"></div>

    <script>
        // 初始化Bmob（已嵌入你的密钥，无需修改）
        Bmob.initialize("你的Application ID", "你的REST API Key");

        // 注册功能
        function userRegister() {
            const username = document.getElementById('regUsername').value.trim();
            const pwd = document.getElementById('regPwd').value.trim();
            const resultBox = document.getElementById('resultBox');
            
            // 简单校验
            if (!username || !pwd) {
                showResult('请完善用户名和密码！', 'error');
                return;
            }

            // 创建用户实例
            const User = Bmob.Object.extend("_User");
            const user = new User();
            user.set("username", username);
            user.set("password", pwd);

            // 提交注册
            user.save(null, {
                success: function(res) {
                    showResult(`注册成功！用户ID：${res.id}`, 'success');
                    // 清空输入框
                    document.getElementById('regUsername').value = '';
                    document.getElementById('regPwd').value = '';
                },
                error: function(res, err) {
                    showResult(`注册失败：${err.message}`, 'error');
                }
            });
        }

        // 登录功能
        function userLogin() {
            const username = document.getElementById('loginUsername').value.trim();
            const pwd = document.getElementById('loginPwd').value.trim();
            
            if (!username || !pwd) {
                showResult('请完善用户名和密码！', 'error');
                return;
            }

            // Bmob官方登录方法
            Bmob.User.logIn(username, pwd, {
                success: function(user) {
                    showResult(`登录成功！当前用户：${user.get('username')}`, 'success');
                    // 清空输入框
                    document.getElementById('loginUsername').value = '';
                    document.getElementById('loginPwd').value = '';
                },
                error: function(user, err) {
                    showResult(`登录失败：${err.message}`, 'error');
                }
            });
        }

        // 结果提示公共方法
        function showResult(text, type) {
            const resultBox = document.getElementById('resultBox');
            resultBox.innerText = text;
            resultBox.className = `result ${type}`;
            resultBox.style.display = 'block';
            // 3秒后自动隐藏提示
            setTimeout(() => {
                resultBox.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>
